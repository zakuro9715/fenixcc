setup:
  command: |
    rustup component add rustfmt
    rustup component add clippy
    cargo install grcov

cargo:
  command: cargo $@

build:
  command: cargo build $@

run:
  command: cargo run

compile-example:
  command: |
    mkdir -p ./tmp
    cargo run "./examples/$1" > "./tmp/$1.s"
    clang "./tmp/$1.s"

lint:
  exec: cargo clippy

clean:
  exec: cargo clean

shell-test:
  commands: |
      {{ .cargo }} -c {{ .robo.file }} @rust-test $@
      {{ .cargo }} -c {{ .robo.file }} @shellltest $@

shell-test:
  script: ./shell-tests/run

test:
  command: |
    {{ .cmd.c }} {{ .chain }} rust-test $@
    {{ .cmd.c }} {{ .chain }} shell--test $@


varables:
  cargo: cargo
  chain: -c {{ .robo.file }}
